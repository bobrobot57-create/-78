# Инструкция для партнёра: настройка оплаты VoiceLab

**Сделай всё по шагам. В конце выдай мне списочком данные — я загружу их в систему.**

---

# ЧАСТЬ 1: FreeKassa

## Шаг 1.1 — Регистрация (если ещё нет)

1. Открой: **https://www.free-kassa.ru/**
2. Нажми **«Регистрация»**
3. Заполни форму, подтверди почту

## Шаг 1.2 — Создание магазина

1. Войди в личный кабинет: **https://www.free-kassa.ru/merchant/**
2. Меню слева → **«Магазины»** или **«Мои магазины»**
3. Нажми **«Добавить магазин»** / **«Создать магазин»**
4. Заполни:
   - **Название:** `VoiceLab` (или как хочешь)
   - **Ссылка на бота:** `https://t.me/NeuralVoiceLabBot`
   - **Ссылка на сайт:** `https://t.me/NeuralVoiceLabBot` (если нет сайта — ту же ссылку)
   - **Описание:** можно оставить пустым или написать «Подписка VoiceLab»
5. Сохрани

## Шаг 1.3 — Получить данные магазина

1. Открой свой магазин в списке
2. Зайди в **«Настройки»** / **«Параметры»** / **«API»**
3. Найди и **скопируй**:
   - **ID магазина** (Merchant ID) — число, например `12345`
   - **Секретное слово 1** (Secret 1)
   - **Секретное слово 2** (Secret 2)

## Шаг 1.4 — Настроить URL оповещения (Webhook)

1. В настройках магазина найди раздел **«Уведомления»** / **«Оповещения»** / **«Notification URL»** / **«URL для уведомлений»**
2. Вставь **ровно** эту ссылку:
   ```
   https://78-production.up.railway.app/payment/freekassa
   ```
3. Метод оповещения выбери: **POST**
4. Сохрани

## Шаг 1.5 — Тестовый режим (опционально)

1. В настройках магазина найди **«Тестовый режим»** / **«Sandbox»**
2. Включи его — можно платить без реальных денег
3. После настройки webhook нажми **«Проверить статус»** — должен быть ответ 200

---

# ЧАСТЬ 2: Cryptomus

## Шаг 2.1 — Регистрация (если ещё нет)

1. Открой: **https://cryptomus.com/**
2. Нажми **«Регистрация»** / **«Sign up»**
3. Заполни форму, подтверди почту

## Шаг 2.2 — Создание мерчанта / магазина

1. Войди в личный кабинет: **https://app.cryptomus.com/** (или **https://cryptomus.com/personal**)
2. Раздел **«Мерчант»** / **«Merchant»** / **«Бизнес»**
3. Создай мерчанта (если ещё нет)
4. При создании/настройке укажи:
   - **Ссылка на бота:** `https://t.me/NeuralVoiceLabBot`
   - **Сайт:** `https://t.me/NeuralVoiceLabBot` (если нет — ту же ссылку)

## Шаг 2.3 — Получить API-ключи

1. В личном кабинете Cryptomus открой **«API»** / **«Настройки API»** / **«API Keys»**
2. Создай ключ для **Payment API** (оплаты)
3. Найди и **скопируй**:
   - **Merchant UUID** (или Merchant ID) — длинная строка вида `8b03432e-385b-4670-8d06-064591096795`
   - **API ключ** (Payment API Key) — секретная строка

## Шаг 2.4 — Webhook (опционально)

Cryptomus получает URL автоматически при каждой оплате — ничего вручную настраивать не нужно. Сервер сам передаёт:
```
https://78-production.up.railway.app/payment/cryptomus
```

---

# ЧАСТЬ 3: Что выдать мне

**Скопируй этот блок, заполни и отправь:**

```
=== FREEKASSA ===
ID магазина: 
Секретное слово 1: 
Секретное слово 2: 

=== CRYPTOMUS ===
Merchant UUID: 
API ключ (Payment): 

=== ПРОВЕРОЧНО ===
FreeKassa URL оповещения настроен: https://78-production.up.railway.app/payment/freekassa (да/нет)
```

---

# Чеклист перед отправкой

- [ ] FreeKassa: магазин создан, ID и оба секретных слова скопированы
- [ ] FreeKassa: URL оповещения вставлен и сохранён
- [ ] Cryptomus: Merchant UUID и API ключ скопированы
- [ ] Блок «Что выдать мне» заполнен и отправлен

---

**После того как ты пришлёшь данные — я загружу их в бота. Потом сделаем тестовый платёж (я задам сумму в ЛК).**

---

# Для разработчика: что делать с данными от партнёра

Когда партнёр пришлёт заполненный блок:

1. **Через админ-бот** (если бот уже запущен):
   - Настройки → FreeKassa → отправить: `ID secret1 secret2`
   - Настройки → Cryptomus → отправить: `merchant_uuid api_key`

2. **Или через Railway Variables** (если предпочитаешь env):
   ```
   FK_MERCHANT_ID=12345
   FK_SECRET_1=слово1
   FK_SECRET_2=слово2
   CRYPTOMUS_MERCHANT=uuid-мерчанта
   CRYPTOMUS_API_KEY=ключ
   ```

3. **Проверь** `WEBHOOK_BASE_URL=https://78-production.up.railway.app`

4. **Тестовый платёж:** партнёр задаёт минимальную сумму в ЛК FreeKassa/Cryptomus, ты оплачиваешь — ключ должен прийти в клиентский бот, уведомление — в админ.
